<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Project Food: –ú–µ–Ω—é –∏ –ö–æ—Ä–∑–∏–Ω–∞</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
    <style>
        :root { --main: #46b8bc; --bg: #f0f4f3; }
        body { font-family: sans-serif; background: var(--bg); margin: 0; padding-bottom: 80px; }
        .header { background: white; padding: 20px; text-align: center; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .page { display: none; padding: 20px; }
        .active { display: block; }
        
        /* –ö–∞—Ä—Ç–æ—á–∫–∏ —Ä–µ—Ü–µ–ø—Ç–æ–≤ */
        .recipe-card { background: white; padding: 15px; border-radius: 15px; margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center; border-left: 5px solid var(--main); }
        .recipe-info h3 { margin: 0; font-size: 18px; }
        .recipe-info p { margin: 5px 0 0; color: #888; font-size: 13px; }

        /* –°–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫ */
        .cart-item { background: white; padding: 12px; border-radius: 12px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; }
        .total-box { background: var(--main); color: white; padding: 20px; border-radius: 15px; text-align: center; margin-bottom: 20px; }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .nav { position: fixed; bottom: 0; width: 100%; background: white; display: flex; border-top: 1px solid #eee; height: 65px; }
        .nav-btn { flex: 1; border: none; background: none; font-size: 14px; color: #aaa; font-weight: bold; }
        .nav-btn.active-tab { color: var(--main); }

        .add-btn { background: var(--main); color: white; border: none; padding: 10px 15px; border-radius: 10px; font-weight: bold; }
        .clear-btn { background: #ff6b6b; color: white; border: none; padding: 10px; border-radius: 10px; width: 100%; margin-top: 10px; }
    </style>
</head>
<body>

    <div class="header">
        <h2 id="page-title" style="margin:0; color:var(--main);">–í—ã–±–æ—Ä –±–ª—é–¥</h2>
    </div>

    <div id="menu-page" class="page active">
        <div id="recipes-list"></div>
    </div>

    <div id="cart-page" class="page">
        <div class="total-box">
            <div style="font-size: 14px; opacity: 0.9;">–ö –û–ü–õ–ê–¢–ï:</div>
            <div style="font-size: 28px; font-weight: bold;"><span id="total-price">0</span> ‚ÇΩ</div>
        </div>
        <div id="shopping-list"></div>
        <button class="clear-btn" onclick="clearCart()">–û—á–∏—Å—Ç–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫</button>
    </div>

    <nav class="nav">
        <button class="nav-btn active-tab" id="btn-menu" onclick="showPage('menu')">üç¥ –ú–µ–Ω—é</button>
        <button class="nav-btn" id="btn-cart" onclick="showPage('cart')">üõí –ö–æ—Ä–∑–∏–Ω–∞</button>
    </nav>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyCg0lFoxG721_P8tlf2fJsHiC7NsoE_EWM",
        authDomain: "foodproject-4aaf3.firebaseapp.com",
        databaseURL: "https://foodproject-4aaf3-default-rtdb.europe-west1.firebasedatabase.app",
        projectId: "foodproject-4aaf3",
        storageBucket: "foodproject-4aaf3.firebasestorage.app",
        messagingSenderId: "9549297996",
        appId: "1:9549297996:web:53af7c7e62317143c177e9"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // –¢–≤–æ—è –±–∞–∑–∞ —Ä–µ—Ü–µ–ø—Ç–æ–≤
    const recipesData = [
        { id: 1, name: "–ë–æ—Ä—â", desc: "–°–≤–µ–∫–ª–∞, –º—è—Å–æ, –∫–∞—Ä—Ç–æ—Ñ–µ–ª—å", price: 450, ingredients: ["–ì–æ–≤—è–¥–∏–Ω–∞ 500–≥", "–°–≤–µ–∫–ª–∞ 2—à—Ç", "–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å 3—à—Ç"] },
        { id: 2, name: "–ü–ª–æ–≤", desc: "–†–∏—Å, –º–æ—Ä–∫–æ–≤—å, –º—è—Å–æ", price: 600, ingredients: ["–†–∏—Å 500–≥", "–ë–∞—Ä–∞–Ω–∏–Ω–∞ 600–≥", "–ú–æ—Ä–∫–æ–≤—å 500–≥"] },
        { id: 3, name: "–¶–µ–∑–∞—Ä—å", desc: "–ö—É—Ä–∏—Ü–∞, —Å–∞–ª–∞—Ç, —Å–æ—É—Å", price: 350, ingredients: ["–ö—É—Ä–∏—Ü–∞ 300–≥", "–°–∞–ª–∞—Ç 1—à—Ç", "–°–æ—É—Å 1—à—Ç"] }
    ];
    function showPage(page) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active-tab'));
        
        if(page === 'menu') {
            document.getElementById('menu-page').classList.add('active');
            document.getElementById('btn-menu').classList.add('active-tab');
            document.getElementById('page-title').innerText = "–í—ã–±–æ—Ä –±–ª—é–¥";
        } else {
            document.getElementById('cart-page').classList.add('active');
            document.getElementById('btn-cart').classList.add('active-tab');
            document.getElementById('page-title').innerText = "–ö–æ—Ä–∑–∏–Ω–∞";
        }
    }

    // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –º–µ–Ω—é
    const recipesDiv = document.getElementById('recipes-list');
    recipesDiv.innerHTML = recipesData.map(r => 
        <div class="recipe-card">
            <div class="recipe-info">
                <h3>${r.name}</h3>
                <p>${r.desc}</p>
                <div style="color:var(--main); font-weight:bold; margin-top:5px;">${r.price} ‚ÇΩ</div>
            </div>
            <button class="add-btn" onclick="addToCloud(${r.id})">–í—ã–±—Ä–∞—Ç—å</button>
        </div>
    ).join('');

    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –æ–±–ª–∞–∫–æ
    function addToCloud(recipeId) {
        const recipe = recipesData.find(r => r.id === recipeId);
        // –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –∫–∞–∂–¥—ã–π –ø—Ä–æ–¥—É–∫—Ç –æ—Ç–¥–µ–ª—å–Ω–æ –≤ –±–∞–∑—É
        recipe.ingredients.forEach(ing => {
            db.ref("cart").push({ name: ing, price: Math.floor(recipe.price / 3) }); // –ü—Ä–∏–º–µ—Ä–Ω—ã–π —Ä–∞—Å—á–µ—Ç —Ü–µ–Ω—ã –Ω–∞ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç
        });
        alert(recipe.name + " –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É!");
    }

    // –ß—Ç–µ–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω—ã –∏–∑ –æ–±–ª–∞–∫–∞
    db.ref("cart").on("value", (snapshot) => {
        const data = snapshot.val();
        const cartDiv = document.getElementById('shopping-list');
        const totalSpan = document.getElementById('total-price');
        cartDiv.innerHTML = "";
        let total = 0;

        if(!data) {
            cartDiv.innerHTML = "<p style='text-align:center'>–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>";
            totalSpan.innerText = "0";
            return;
        }

        for(let id in data) {
            total += data[id].price;
            cartDiv.innerHTML += 
                <div class="cart-item">
                    <span>${data[id].name}</span>
                    <span style="font-weight:bold">${data[id].price} ‚ÇΩ</span>
                </div>;
        }
        totalSpan.innerText = total;
    });

    function clearCart() {
        if(confirm("–û—á–∏—Å—Ç–∏—Ç—å –≤–µ—Å—å —Å–ø–∏—Å–æ–∫?")) db.ref("cart").remove();
    }
</script>
</body>
</html>
