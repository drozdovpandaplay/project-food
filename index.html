<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Project Food: Auto-Fix</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
    <style>
        :root { --main: #46b8bc; --bg: #f4f7f6; --white: #ffffff; }
        body { font-family: -apple-system, sans-serif; background: var(--bg); margin: 0; padding-bottom: 80px; }
        .header { background: #fff; padding: 15px; position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .search-box { width: 100%; padding: 12px; border-radius: 12px; border: 1px solid #eee; font-size: 16px; box-sizing: border-box; }
        .recipe-card { background: #fff; margin: 15px; padding: 18px; border-radius: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); cursor: pointer; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #fff; z-index: 1000; padding: 20px; box-sizing: border-box; overflow-y: auto; }
        .modal.active { display: block; }
        .step-item { display: flex; gap: 10px; margin-bottom: 10px; }
        .step-num { background: var(--main); color: #fff; width: 24px; height: 24px; border-radius: 50%; text-align: center; font-size: 12px; line-height: 24px; flex-shrink: 0; }
        .nav { position: fixed; bottom: 0; width: 100%; height: 70px; background: #fff; display: flex; box-shadow: 0 -2px 10px rgba(0,0,0,0.05); }
        .nav-btn { flex: 1; border: none; background: none; font-weight: bold; color: #ccc; }
        .nav-btn.active { color: var(--main); }
        .btn { background: var(--main); color: #fff; border: none; padding: 15px; border-radius: 12px; width: 100%; font-weight: bold; margin-top: 15px; }
    </style>
</head>
<body>

    <div class="header" id="header-ui">
        <input type="text" id="searchInput" class="search-box" placeholder="üîç –ù–∞–π—Ç–∏ –±–ª—é–¥–æ..." oninput="render()">
    </div>

    <div id="menu-page" class="page active">
        <div id="loader" style="text-align:center; padding:50px;">–ó–∞–≥—Ä—É–∑–∫–∞ –º–µ–Ω—é...</div>
        <div id="recipes-list"></div>
    </div>

    <div id="cart-page" class="page" style="display:none; padding:15px;">
        <h2>üõí –ö–æ—Ä–∑–∏–Ω–∞</h2>
        <div id="cart-content"></div>
        <button class="btn" style="background:#ff7675;" onclick="clearCart()">–û—á–∏—Å—Ç–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É</button>
    </div>

    <div id="recipe-modal" class="modal">
        <button onclick="closeRecipe()" style="border:none; background:#eee; padding:10px; border-radius:10px; margin-bottom:15px;">‚Üê –ù–∞–∑–∞–¥</button>
        <div id="modal-data"></div>
    </div>

    <nav class="nav">
        <button class="nav-btn active" id="b-menu" onclick="showPage('menu')">üè† –ú–µ–Ω—é</button>
        <button class="nav-btn" id="b-cart" onclick="showPage('cart')">üõí –ö–æ—Ä–∑–∏–Ω–∞</button>
    </nav>

<script>
    // –¢–í–û–ô –ö–û–ù–§–ò–ì (–ü—Ä–æ–≤–µ—Ä—å –µ–≥–æ –µ—â–µ —Ä–∞–∑ –≤ –∫–æ–Ω—Å–æ–ª–∏ Firebase!)
    const firebaseConfig = {
        apiKey: "AIzaSyCg0lFoxG721_P8tlf2fJsHiC7NsoE_EWM",
        authDomain: "foodproject-4aaf3.firebaseapp.com",
        databaseURL: "https://foodproject-4aaf3-default-rtdb.europe-west1.firebasedatabase.app",
        projectId: "foodproject-4aaf3",
        storageBucket: "foodproject-4aaf3.firebasestorage.app",
        messagingSenderId: "9549297996",
        appId: "1:9549297996:web:53af7c7e62317143c177e9"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // 10 –†–ï–¶–ï–ü–¢–û–í –î–õ–Ø –ê–í–¢–û–ó–ê–ü–û–õ–ù–ï–ù–ò–Ø
    const defaultRecipes = [
        { id: 1, name: "–ë–æ—Ä—â", kcal: 350, ings: ["–°–≤–µ–∫–ª–∞", "–ì–æ–≤—è–¥–∏–Ω–∞", "–ö–∞–ø—É—Å—Ç–∞"], steps: ["–°–≤–∞—Ä–∏—Ç—å –±—É–ª—å–æ–Ω.", "–û–±–∂–∞—Ä–∏—Ç—å –æ–≤–æ—â–∏.", "–í–∞—Ä–∏—Ç—å 20 –º–∏–Ω—É—Ç."] },
        { id: 2, name: "–û–≤—Å—è–Ω–∫–∞", kcal: 220, ings: ["–•–ª–æ–ø—å—è", "–ú–æ–ª–æ–∫–æ", "–Ø–≥–æ–¥—ã"], steps: ["–í—Å–∫–∏–ø—è—Ç–∏—Ç—å –º–æ–ª–æ–∫–æ.", "–í–∞—Ä–∏—Ç—å 5 –º–∏–Ω—É—Ç.", "–£–∫—Ä–∞—Å–∏—Ç—å —è–≥–æ–¥–∞–º–∏."] },
        { id: 3, name: "–ü–∞—Å—Ç–∞", kcal: 500, ings: ["–ú–∞–∫–∞—Ä–æ–Ω—ã", "–°—ã—Ä", "–ë–µ–∫–æ–Ω"], steps: ["–í–∞—Ä–∏—Ç—å –ø–∞—Å—Ç—É 8 –º–∏–Ω—É—Ç.", "–û–±–∂–∞—Ä–∏—Ç—å –±–µ–∫–æ–Ω.", "–°–º–µ—à–∞—Ç—å."] }
        // –î–æ–±–∞–≤—å –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å—é–¥–∞ –ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏
    ];

    let currentRecipes = [];

    // –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
    function init() {
        db.ref("recipes").on("value", (snap) => {
            const data = snap.val();
            if (!data) {
                console.log("–ë–∞–∑–∞ –ø—É—Å—Ç–∞, –∑–∞–ª–∏–≤–∞—é –¥–µ—Ñ–æ–ª—Ç...");
                defaultRecipes.forEach(r => db.ref("recipes").push(r));
            } else {
                currentRecipes = Object.values(data);
                document.getElementById('loader').style.display = 'none';
                render();
            }
        });
    }

    function render() {
        const q = document.getElementById('searchInput').value.toLowerCase();
        const list = document.getElementById('recipes-list');
        list.innerHTML = currentRecipes
            .filter(r => r.name.toLowerCase().includes(q))
            .map(r => `
                <div class="recipe-card" onclick="openRecipe('${r.name}')">
                    <h3 style="margin:0">${r.name}</h3>
                    <small>${r.kcal} –∫–∫–∞–ª</small>
                </div>
            `).join('');
    }

    function openRecipe(name) {
        const r = currentRecipes.find(x => x.name === name);
        const modal = document.getElementById('recipe-modal');
        document.getElementById('modal-data').innerHTML = `
            <h1>${r.name}</h1>
            <p><b>–ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã:</b> ${r.ings.join(', ')}</p>
            <h3>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:</h3>
            ${r.steps.map((s, i) => `<div class="step-item"><div class="step-num">${i+1}</div><div>${s}</div></div>`).join('')}
            <button class="btn" onclick="addToCart('${r.name}')">–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</button>
        `;
        modal.classList.add('active');
    }

    function closeRecipe() { document.getElementById('recipe-modal').classList.remove('active'); }

    function addToCart(name) {
        const r = currentRecipes.find(x => x.name === name);
        r.ings.forEach(i => db.ref("cart").push({ name: i, dish: r.name }));
        alert("–î–æ–±–∞–≤–ª–µ–Ω–æ!");
    }

    db.ref("cart").on("value", (snap) => {
        const data = snap.val();
        const cont = document.getElementById('cart-content');
        cont.innerHTML = "";
        if(!data) { cont.innerHTML = "–ü—É—Å—Ç–æ"; return; }
        for(let k in data) {
            cont.innerHTML += `<div style="padding:10px; border-bottom:1px solid #eee;"><b>${data[k].name}</b> <small>(${data[k].dish})</small></div>`;
        }
    });

    function showPage(p) {
        document.getElementById('menu-page').style.display = (p === 'menu' ? 'block' : 'none');
        document.getElementById('cart-page').style.display = (p === 'cart' ? 'block' : 'none');
        document.getElementById('header-ui').style.display = (p === 'menu' ? 'block' : 'none');
        document.getElementById('b-menu').classList.toggle('active', p === 'menu');
        document.getElementById('b-cart').classList.toggle('active', p === 'cart');
    }

    function clearCart() { db.ref("cart").remove(); }

    init();
</script>
</body>
</html>
