<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Project Food: Master Edition</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
    <style>
        :root { --main: #46b8bc; --bg: #f4f7f6; --dark: #2d3436; --white: #ffffff; }
        body { font-family: -apple-system, system-ui, sans-serif; background: var(--bg); margin: 0; padding-bottom: 90px; color: var(--dark); }
        
        .header { background: var(--white); padding: 15px; position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 10px rgba(0,0,0,0.05); text-align: center; }
        .page { display: none; padding: 15px; }
        .active { display: block; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity:0; } to { opacity:1; } }

        /* –ö–∞—Ä—Ç–æ—á–∫–∞ –±–ª—é–¥–∞ */
        .recipe-card { background: var(--white); border-radius: 22px; margin-bottom: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); padding: 18px; cursor: pointer; border: 1px solid transparent; transition: 0.2s; }
        .recipe-card:active { transform: scale(0.98); border-color: var(--main); }
        
        .category-tag { font-size: 10px; text-transform: uppercase; color: var(--main); font-weight: 800; }
        .recipe-meta { display: flex; gap: 8px; margin: 10px 0; font-size: 11px; font-weight: 600; }
        .meta-item { background: #f0f3f2; padding: 4px 10px; border-radius: 12px; color: #636e72; }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ (–°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ—Ü–µ–ø—Ç–∞) */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--white); z-index: 1000; overflow-y: auto; padding: 20px; box-sizing: border-box; }
        .modal.active { display: block; animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        
        .close-modal { background: #eee; border: none; padding: 10px 20px; border-radius: 12px; font-weight: bold; margin-bottom: 20px; }
        .ing-list-detail { list-style: none; padding: 0; }
        .ing-list-detail li { padding: 12px 0; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .nav { position: fixed; bottom: 0; width: 100%; background: var(--white); display: flex; height: 75px; box-shadow: 0 -5px 20px rgba(0,0,0,0.05); }
        .nav-btn { flex: 1; border: none; background: none; font-size: 11px; color: #b2bec3; font-weight: bold; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .nav-btn.active-tab { color: var(--main); }

        .btn-add { background: var(--main); color: var(--white); border: none; padding: 16px; border-radius: 16px; width: 100%; font-weight: 800; cursor: pointer; }
    </style>
</head>
<body>

    <div class="header">
        <h2 style="margin:0; font-size: 20px; color: var(--main);">Project Food</h2>
    </div>

    <div id="menu-page" class="page active">
        <div id="recipes-container"></div>
    </div>

    <div id="cart-page" class="page">
        <div id="cart-items"></div>
    </div>

    <div id="recipe-modal" class="modal">
        <button class="close-modal" onclick="closeRecipe()">‚Üê –ù–∞–∑–∞–¥ –∫ –º–µ–Ω—é</button>
        <div id="modal-content"></div>
    </div>

    <nav class="nav">
        <button class="nav-btn active-tab" id="n-menu" onclick="showPage('menu')">üè† –ú–µ–Ω—é</button>
        <button class="nav-btn" id="n-cart" onclick="showPage('cart')">üõí –ö–æ—Ä–∑–∏–Ω–∞</button>
    </nav>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyCg0lFoxG721_P8tlf2fJsHiC7NsoE_EWM",
        authDomain: "foodproject-4aaf3.firebaseapp.com",
        databaseURL: "https://foodproject-4aaf3-default-rtdb.europe-west1.firebasedatabase.app",
        projectId: "foodproject-4aaf3",
        storageBucket: "foodproject-4aaf3.firebasestorage.app",
        messagingSenderId: "9549297996",
        appId: "1:9549297996:web:53af7c7e62317143c177e9"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // –ë–∞–∑–∞ —Ä–µ—Ü–µ–ø—Ç–æ–≤ (–¥–æ–±–∞–≤–ª–µ–Ω–∞ —Å–µ–∫—Ü–∏—è 'desc' –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã)
    const recipes = [
        { 
            id: 1, cat: "–ó–∞–≤—Ç—Ä–∞–∫", name: "–û–≤—Å—è–Ω–∫–∞ —Å —è–≥–æ–¥–∞–º–∏", kcal: 320, weight: 300, basePrice: 150, 
            desc: "–ò–¥–µ–∞–ª—å–Ω—ã–π –∑–∞–≤—Ç—Ä–∞–∫ –¥–ª—è —ç–Ω–µ—Ä–≥–∏–∏. –ú–µ–¥–ª–µ–Ω–Ω—ã–µ —É–≥–ª–µ–≤–æ–¥—ã –∏ –∞–Ω—Ç–∏–æ–∫—Å–∏–¥–∞–Ω—Ç—ã –∏–∑ —è–≥–æ–¥.",
            ings: [{n: "–û–≤—Å—è–Ω–∫–∞", q: 100, u: "–≥", p: 40}, {n: "–Ø–≥–æ–¥—ã", q: 50, u: "–≥", p: 80}, {n: "–ú–æ–ª–æ–∫–æ", q: 150, u: "–º–ª", p: 30}] 
        },
        { 
            id: 2, cat: "–û–±–µ–¥", name: "–ë–æ—Ä—â –î–æ–º–∞—à–Ω–∏–π", kcal: 380, weight: 400, basePrice: 320, 
            desc: "–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π –Ω–∞–≤–∞—Ä–∏—Å—Ç—ã–π –±–æ—Ä—â –Ω–∞ –≥–æ–≤—è–¥–∏–Ω–µ —Å–æ —Å–≤–µ–∂–µ–π –∫–∞–ø—É—Å—Ç–æ–π –∏ —Å–≤–µ–∫–ª–æ–π.",
            ings: [{n: "–ì–æ–≤—è–¥–∏–Ω–∞", q: 150, u: "–≥", p: 200}, {n: "–°–≤–µ–∫–ª–∞", q: 100, u: "–≥", p: 40}, {n: "–ö–∞–ø—É—Å—Ç–∞", q: 100, u: "–≥", p: 40}] 
        },
        { 
            id: 3, cat: "–£–∂–∏–Ω", name: "–ü–∞—Å—Ç–∞ –ö–∞—Ä–±–æ–Ω–∞—Ä–∞", kcal: 650, weight: 350, basePrice: 450, 
            desc: "–ò—Ç–∞–ª—å—è–Ω—Å–∫–∞—è –∫–ª–∞—Å—Å–∏–∫–∞ —Å –±–µ–∫–æ–Ω–æ–º, –ø–∞—Ä–º–µ–∑–∞–Ω–æ–º –∏ —è–∏—á–Ω—ã–º –∂–µ–ª—Ç–∫–æ–º.",
            ings: [{n: "–°–ø–∞–≥–µ—Ç—Ç–∏", q: 120, u: "–≥", p: 90}, {n: "–ë–µ–∫–æ–Ω", q: 80, u: "–≥", p: 160}, {n: "–°—ã—Ä", q: 40, u: "–≥", p: 200}] 
        }
    ];

    let selectedPersons = {};

    function renderMenu() {
        const container = document.getElementById('recipes-container');
        container.innerHTML = recipes.map(r => {
            const p = selectedPersons[r.id] || 2;
            return `
            <div class="recipe-card" onclick="openRecipe(${r.id})">
                <div class="category-tag">${r.cat}</div>
                <h3 style="margin:5px 0;">${r.name}</h3>
                <div class="recipe-meta">
                    <span class="meta-item">üî• ${r.kcal*p} –∫–∫–∞–ª</span>
                    <span class="meta-item">‚öñÔ∏è ${r.weight*p} –≥</span>
                </div>
                <div style="font-size:12px; color:#999; margin-bottom:10px;">–ù–∞–∂–º–∏, —á—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏</div>
                <div style="font-weight:900; color:var(--main); font-size:20px;">${r.basePrice*p} ‚ÇΩ</div>
            </div>`;
        }).join('');
    }

    function openRecipe(id) {
        const r = recipes.find(x => x.id === id);
        const p = selectedPersons[id] || 1; // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ –Ω–∞ 1 —á–µ–ª –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏–ª–∏ –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–µ —á–∏—Å–ª–æ
        const modal = document.getElementById('recipe-modal');
        const content = document.getElementById('modal-content');

        content.innerHTML = `
            <div class="category-tag">${r.cat}</div>
            <h1 style="margin:10px 0;">${r.name}</h1>
            <p style="color:#636e72; line-height:1.5;">${r.desc}</p>
            
            <h3 style="margin-top:30px;">–ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã –∏ –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ (–Ω–∞ ${p} —á–µ–ª.):</h3>
            <ul class="ing-list-detail">
                ${r.ings.map(ing => `
                    <li>
                        <span>${ing.n}</span>
                        <span style="font-weight:bold">${(ing.q * p).toFixed(1)} ${ing.u}</span>
                    </li>
                `).join('')}
            </ul>

            <div style="margin-top:30px; background:#f9f9f9; padding:20px; border-radius:15px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
                    <span>–ò—Ç–æ–≥–æ–≤—ã–π –≤–µ—Å:</span> <b>${r.weight * p} –≥</b>
                </div>
                <div style="display:flex; justify-content:space-between;">
                    <span>–≠–Ω–µ—Ä–≥. —Ü–µ–Ω–Ω–æ—Å—Ç—å:</span> <b>${r.kcal * p} –∫–∫–∞–ª</b>
                </div>
            </div>
            
            <button class="btn-add" style="margin-top:30px;" onclick="addToCloud(${r.id}); closeRecipe();">–î–û–ë–ê–í–ò–¢–¨ –í –ö–û–†–ó–ò–ù–£</button>
        `;
        modal.classList.add('active');
        document.body.style.overflow = 'hidden'; // –ó–∞–ø—Ä–µ—Ç –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ —Ñ–æ–Ω–∞
    }

    function closeRecipe() {
        document.getElementById('recipe-modal').classList.remove('active');
        document.body.style.overflow = 'auto';
    }

    function addToCloud(id) {
        const r = recipes.find(x => x.id === id);
        const p = selectedPersons[id] || 1;
        r.ings.forEach(ing => {
            db.ref("cart").push({ name: ing.n, amount: (ing.q * p).toFixed(1), unit: ing.u, price: ing.p * p, dish: r.name, checked: false });
        });
        alert("–ü—Ä–æ–¥—É–∫—Ç—ã –¥–ª—è '" + r.name + "' –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –∫–æ—Ä–∑–∏–Ω—É!");
    }

    function showPage(p) {
        document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
        document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active-tab'));
        document.getElementById(p + '-page').classList.add('active');
        document.getElementById('n-' + p).classList.add('active-tab');
        closeRecipe();
    }

    renderMenu();
</script>
</body>
</html>
